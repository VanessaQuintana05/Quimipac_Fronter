@using Quimipac_.Repositorio;
@using Quimipac_.Models
@model Quimipac_.Models.Orden_Trabajo_FiltCli
@{
    Layout = "~/Views/Shared/_MainLayout.cshtml";

    var listaOrdenTrabajo = ViewBag.listaOrdenTrabajo as List<sp_Quimipac_ConsultaMT_OrdenTrabajo_Result>;

    var listalkTipo_Trabajo = ViewBag.listalkTipo_Trabajo;
    var listalkCampamento = ViewBag.listalkCampamento;
    var listalkSucursal = ViewBag.listalkSucursal;
    var listalkEstacion = ViewBag.listalkEstacion;
    var listalkSector = ViewBag.listalkSector;
    var listalkContrato = ViewBag.listalkContrato;
    var listalkEstado = ViewBag.listalkEstado;
    var listakClientes = ViewBag.listakClientes;// as List<sp_LINK_ConsultaClientes_Result>;

    var lkFiltro = TempData["listaFiltro"] as List<ParametrosBusquedaOT>;
    var ParametroBusqueda = TempData["ParametroBusqueda"] as string;
    //var ParametroBusqueda = ViewBag.ParametroBusqueda;

    //if(TempData["ParametroBusqueda"].ToString() != null){
    //    cadBusqueda = TempData["ParametroBusqueda"].ToString();

    //}
}

<title>Fronter | Orden de Trabajo</title>

<!--COMBO FILTRABLE-->
<link rel="stylesheet" href="~/Content/bower_components/select2/dist/css/select2.css">
<link rel="stylesheet" href="~/Content/bower_components/datatables.net-bs/css/dataTables.bootstrap.css">

@*@*BotonInf*@
<link rel="stylesheet" href="~/Content/bower_components/FiltroDataTable/cssImgInf/Iicono.css" />
<link rel="stylesheet" href="~/Content/bower_components/FiltroDataTable/ValidaInputVQ/css/contornoText.css" />

@*DisenoCanvas*@
<link rel="stylesheet" href="~/Content/bower_components/FiltroDataTable/CanvasDiseno/Canvas.css" />
<!-- EstiloGeneral-->
<link rel="stylesheet" href="~/Content/bower_components/EstiloExterno/EstiloGral.css" />
@* Boton input archivo *@
<link href="~/Content/bower_components/bootstrap/dist/css/file-input.css" rel="stylesheet" />
@* hasta aqui *@

<section class="content-header">
    <h2 style="text-align:left">
        Orden de Trabajo
    </h2>

    <ol class="breadcrumb">
        <li>
            <a href="@Url.Action("Default", "Main")">
                <i class="fa fa-link">
                </i>Home
            </a>
        </li>
        <li class="breadcrumb-item active">Orden de Trabajo</li>
    </ol>

    <div class="row">
        <div class="col-md-12">
            @if (TempData["mensaje_error"] != null)
            {
                <div class="alert alert-danger">
                    <strong>@TempData["mensaje_error"]</strong>
                    <button type="button" id="alert" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            }

            @if (TempData["mensaje_correcto"] != null)
            {
                <div class="alert alert-success">
                    <strong>@TempData["mensaje_correcto"]</strong>
                    <button type="button" id="alert" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            }

            @if (TempData["mensaje_actualizado"] != null)
            {
                <div class="alert alert-warning">
                    <strong>@TempData["mensaje_actualizado"]</strong>
                    <button type="button" id="alert" class="close" data-dismiss="alert" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
            }

        </div>
    </div>

    <div class="row">
        <div class="col-md-2">
            <a href="@Url.Action("Agregar_OrdenTrabajo", "OrdenTrabajo")" type="button" class="btn btn-sm btn-warning" data-original-title="Agrega Orden Trabajo">
                <span class="fa fa-plus-circle"></span>&nbsp;&nbsp;Agregar Orden Trabajo
            </a>
        </div>
        <div class="col-md-2">
            @using (Html.BeginForm("Import", "OrdenTrabajo", FormMethod.Post, new { enctype = "multipart/form-data", @type = "button" }))
            {

                @Html.Raw(ViewBag.Error) // si tienes el decorador [ValidateAntiForgeryToken] en tu accion del controlador
                                                                    @*<span>Excel File</span>*@
                                                                    @* este era el unico q estaba anteriormemte <input type="file" name="excelfile"><input type="submit" value="Import"/>*@
                <input type="file" name="file-1" id="file-1" class="inputfile inputfile-1" data-multiple-caption="{count} archivos seleccionados" multiple /><label for="file-1"><svg xmlns="http://www.w3.org/2000/svg" class="iborrainputfile" width="20" height="17" viewBox="0 0 20 17"><path d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z"></path></svg><span class="iborrainputfile">Seleccionar archivo</span></label><input type="submit" value="Import" name="file-1" id="file-1" class="inputfile inputfile-1" /><label for="file-1"><span class="iborrainputfile">Import</span></label>
            }
        </div>

    </div>
</section>

<section class="content">

    <div class="row">
        <div class="col-md-12">
            <div class="box box-default" id ="BordeDiv">

                <!--Div botones-->

                <div class="box-body">
                    <div class="row col-md-12">

                        <!--2  <div class="container1">
                            <div class="scroll1">-->



                        <div class="table-responsive">

                            <table>
                                @*          table table-bordered table-hover  ">*@
                                <tr>
                                    <td>
                                        <button id="btnLista" type="button" class="btn btn-xs btn-info" value="MostrarLista" onclick="mostrarLista()">
                                            <span class="fa fa-list-alt"></span>
                                            &nbsp;&nbsp;Lista&nbsp;&nbsp;
                                        </button>
                                    </td>
                                    <td>
                                        <button id="btnCanvas" type="button" class="btn btn-xs btn-warning" value="MostrarCanvas" onclick="mostrarCanvasUDP()">
                                            <span class="fa fa-th-large"></span>&nbsp;&nbsp;Canvas&nbsp;&nbsp;
                                        </button>
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-xs" style="background-color:#865fc5" onclick="mostrarDivFiltro()">
                                            <font color="white">&nbsp;&nbsp;Filtrar&nbsp;&nbsp;<span class="glyphicon glyphicon-filter"></span></font>
                                        </button>
                                    </td>
                                                                       
                                    <td>
                                        <!--Filtro -->
                                        <table>
                                            <tr>
                                                <td>
                                                    <!--Div Filtro-->
                                                    <div id="divFiltro" class="table-responsive Contenedor" style="display:none;overflow-y: hidden;">
                                                        @*table table-bordered table-hover  "><thea d>*@
                                                        @using (Html.BeginForm("OrdenTrabajo", "OrdenTrabajo", new { @id = string.Empty }, FormMethod.Post, new { @id = "modal1" }))
                                                        {
                                                            @Html.AntiForgeryToken() //ParametrosBusquedaOT paramBusca = new ParametrosBusquedaOT(); table-responsive col-md-12"
                                                            <table class="" style="font-size:12px" border="0">
                                                                <tr>
                                                                    @*F. Asignacion*@
                                                                    <td nowrap><span style="margin-left:6px">&nbsp;&nbsp;</span><span class="fa fa-calendar"></span>&nbsp;&nbsp;&nbsp;&nbsp;Desde</td>
                                                                    <td nowrap><span style="margin-left:2px">&nbsp;&nbsp;</span></td>
                                                                    <td nowrap>
                                                                        @Html.EditorFor(model => model.Fecha_asignacion_grupo_trabajo, new { htmlAttributes = new { @name = "FeInicio", @class = "form-control is-valid", @type = "text", @required = "required", @id = "FeInicio", @style = "height:22px;width:88px;font-size: 9pt;" } })
                                                                        @Html.ValidationMessageFor(model => model.Fecha_asignacion_grupo_trabajo, "", new { @class = "text-danger" })
                                                                    </td>
                                                                    <td nowrap><span style="margin-left:4px">&nbsp;&nbsp;</span></td>
                                                                    <td nowrap><span class="fa fa-calendar"> </span>&nbsp;&nbsp;Hasta</td>
                                                                    <td nowrap><span style="margin-left:2px">&nbsp;&nbsp;</span></td>
                                                                    <td nowrap>
                                                                        @Html.EditorFor(model => model.Fecha_registro, new { htmlAttributes = new { @name = "FeFin", @id = "FeFin", @class = "form-control is-valid", @type = "text", @required = "required", @style = "height:22px;width:88px;font-size: 9pt;" } })
                                                                        @Html.ValidationMessageFor(model => model.Fecha_registro, "", new { @class = "text-danger" })
                                                                    </td>
                                                                    <td nowrap><span style="margin-left:4px">&nbsp;&nbsp;</span></td>
                                                                    <td nowrap><span class="fa fa-ellipsis-v"> </span>&nbsp;&nbsp;Par&aacute;metro</td>
                                                                    <td nowrap><span style="margin-left:2px">&nbsp;&nbsp;</span></td>
                                                                    <td nowrap>
                                                                        @*@Html.DropDownList("IdCmbParametro", new SelectList(new List<string>() { "Ninguno", "Tipos de Trabajo", "Campamento", "Estacion", "Sector", "Sucursal" }), new { @id = "CmbParametro", @class = "form-control select2", @style = "height:27px;width:145px;font-size:6pt", @onchange = "CmbParametroSelected();" })*@
                                                                        @Html.DropDownListFor(model => model.Origen, new SelectList(new List<string>() { "Ninguno", "Tipos_Trabajo", "Campamento", "Estacion", "Sector", "Sucursal", "Contrato", "Estado", "Cliente" }), new { @id = "CmbParametro", @class = "form-control select2", @style = "height:27px;width:145px;font-size:6pt", @onchange = "CmbParametroSelected();" })
                                                                    </td>
                                                                    <td nowrap><span style="margin-left:4px">&nbsp;&nbsp;</span>Ingrese:</td>
                                                                    <td nowrap><span style="margin-left:2px">&nbsp;&nbsp;</span></td>
                                                                    <td nowrap style="padding:0 0 0 0">

                                                                        <div class="" id="formTipoTrabajo">
                                                                            @Html.DropDownListFor(model => model.Id_tipo_trabajo_ejecutado, (SelectList)listalkTipo_Trabajo, new { @class = "form-control select2", @style = "height:27px; width: 135px; font-size:6pt", @id = "comboTipoTrabajo" })
                                                                        </div>

                                                                        <div class="" id="formCampamento">
                                                                            @Html.DropDownListFor(model => model.Id_campamento, (SelectList)listalkCampamento, new { @class = "form-control select2", @style = "height:27px;width:135px;font-size:6pt", @id = "comboCampamento" })
                                                                        </div>
                                                                        <div class="" id="formSucursal">
                                                                            @Html.DropDownListFor(model => model.Id_sucursal, (SelectList)listalkSucursal, new { @class = "form-control select2", @style = "height:27px;width:135px;font-size:6pt", @id = "comboSucursal" })
                                                                        </div>
                                                                        <div class="" id="formEstacion">
                                                                            @Html.DropDownListFor(model => model.Id_estacion, (SelectList)listalkEstacion, new { @class = "form-control select2", @style = "height:27px;width:135px;font-size:6pt", @id = "comboEstacion" })
                                                                        </div>
                                                                        <div class="" id="formSector">
                                                                            @Html.DropDownListFor(model => model.Id_sector, (SelectList)listalkSector, new { @class = "form-control select2", @style = "height:27px;width:135px;font-size:6pt", @id = "comboSector" })
                                                                        </div>
                                                                        @* recien agregue *@
                                                                        <div class="" id="formContrato">
                                                                            @Html.DropDownListFor(model => model.Id_contrato, (SelectList)listalkContrato, new { @class = "form-control select2", @style = "height:27px;width:135px;font-size:6pt", @id = "comboContrato" })
                                                                        </div>
                                                                        <div class="" id="formEstado">
                                                                            @Html.DropDownListFor(model => model.Estado, (SelectList)listalkEstado, new { @class = "form-control select2", @style = "height:27px;width:135px;font-size:6pt", @id = "comboEstado" })
                                                                        </div>
                                                                        @*<div class="" id="formCliente">
                                                                            @Html.DropDownListFor(model => model.cod_cli, (SelectList)listakClientes, new { @class = "form-control select2", @style = "height:27px;width:135px;font-size:6pt", @id = "comboCliente" })
                                                                            @*/@<select id="clientes" name="clientes" class = "form-control select2" style = "height:27px;width:135px;font-size:6pt">
                                                                                @foreach (var item in listakClientes)
                                                                                {
                                                                                   <option value="@item.cod_cli"  >@item.nom_cli
                                                                                   </option>
                                                                                }
                                                                            </select>*/@
                                                                        </div>*@
                                                                         <div class="" id="formCliente">
                                                                            @Html.DropDownListFor(model => model.cod_cli, (SelectList)listakClientes, new { @class = "form-control select2", @style = "height:27px;width:135px;font-size:6pt", @id = "comboCliente" })
                                                                        </div>
                                                                       

                                                                        <!--}-->
                                                                    </td>
                                                                    <td nowrap><span style="margin-left:6px">&nbsp;&nbsp;</span></td>
                                                                    <td nowrap>
                                                                        @* <input type="submit" value="  Buscar  " id="" style="background-color:#865fc5;border-color:#865fc5;color:white;" onclick=""> @*<span class="glyphicon glyphicon-search"></span>*@
                                                                        <button type="button" style="background-color:#865fc5;border-color:#865fc5;color:white;" onclick="ValidaFecha(this)">Buscar</button>
                                                                        <input type="submit" id="btnSubmitFiltro" hidden="hidden" />
                                                                    </td>
                                                                </tr>
                                                            </table>
                                                        }
                                                        <!--Fin Div Filtro-->
                                                    </div>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <!--2  </div>
                        </div> -->

                    </div>
                </div>


                <!--divLista-->
                <div class="row" id="divLista">
                    <div class="col-md-12">
                        <div class="box-body" id="CssDivBox">
                            @{
                                if (lkFiltro == null)
                                {
                                    if (listaOrdenTrabajo != null)// && lkFiltro != null)
                                    {
                                        if (listaOrdenTrabajo.Count != 0)
                                        {
                                            @*<div class="table-responsive">label class="col-md-12" style="color:white;background-color:#f2f5f7; text-align: center;height:24px;padding:2px 0 0 0">*@
                                            <div class="table-responsive">

                                                <table id="tablaTiposTrabajo" class="js-dynamitable table table-bordered  ">
                                                    @*          table table-bordered table-hover  ">*@
                                                    <thead>
                                                        <tr>
                                                            <th>Acciones</th>
                                                            <th>C&oacute;digo</th>
                                                            <th>Nombre Contrato</th>
                                                            <th>Parametro</th>

                                                        </tr>
                                                        <tr>
                                                            <th></th>
                                                            <th><input class="js-filter form-control" type="text" value="" placeholder="Codigo"></th>
                                                            <th><input class="js-filter form-control" type="text" value="" placeholder="Persona"></th>
                                                            <th><input class="js-filter form-control" type="text" value="" placeholder="Parametro"></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>

                                                        @{int cntFila = 0; string estilo = string.Empty;}
                                                        @foreach (var ordenTrabajo in listaOrdenTrabajo)
                                                        {
                                                            if ((cntFila % 2) == 0)
                                                            {
                                                                estilo = "background-color:#f9f9f9";
                                                            }
                                                            else
                                                            {
                                                                estilo = "";
                                                            }


                                                            DataBase_Externo dbe = new DataBase_Externo();
                                                            var objMT_TipoTrab = dbe.ObtenerCriterioAccionOT(ordenTrabajo.Id_tipo_trabajo_ejecutado);

                                                            string parametros = dbe.IsValidParametro(ordenTrabajo.Id_OrdenTrabajo, ordenTrabajo.Id_contrato, ordenTrabajo.Codigo_Cliente);

                                                            if (parametros != null)
                                                            {
                                                                <tr style="@estilo">
                                                                    <td>

                                                                        <a href="@Url.Action("Editar_OrdenTrabajo", "OrdenTrabajo", new { id = @ordenTrabajo.Id_OrdenTrabajo })" data-popup="tooltip" title="Editar" target="_self" class="btn btnEditarBoton class_editar_OrdenTrabajo" style="text-align:center">
                                                                            @*<span aria-hidden="true" class="glyphicon glyphicon-edit">
                                                                                </span>*@
                                                                        </a>


                                                                        @*<a href="@Url.Action("EliminarTipoTrabajo", "OrdenTrabajo", new { id = ordenTrabajo.Id_OrdenTrabajo })" target="_self" class="btn btn-primary" title="Eliminar" style="text-align:center">
                                                                                <span aria-hidden="true" class="glyphicon glyphicon-remove"> </span>
                                                                            </a>*@

                                                                        @*<button type="button" class="btn btnEditarBoton class_editar_EntregaOrden" title="Editar" style="text-align:center" data-toggle="modal" data-target="#modalEditarEntregaOrden" data-id="@ordenTrabajo.Id_OrdenTrabajo">
                                                                                <span aria-hidden="true" class="glyphicon glyphicon-stop"> </span>
                                                                            </button>*@

                                                                        @*<a href="@Url.Action("OrdenEntregaTrabajoOrden", "OrdenTrabajo", new { id = ordenTrabajo.Id_OrdenTrabajo })" target="_self" class="btn btn-primary" title="EntregaOrdenTrabajo" style="text-align:center">
                                                                                <span aria-hidden="true" class="glyphicon glyphicon-stop"> </span>
                                                                            </a>*@


                                                                        <a href="@Url.Action("Actividades_OrdenTrabajo", "OrdenTrabajo", new { id = ordenTrabajo.Id_OrdenTrabajo })" target="_self" class="btn btnActividadesBoton" title="Actividades" style="text-align:center">
                                                                            @*<span aria-hidden="true" class="glyphicon glyphicon-list"> </span>*@
                                                                        </a>
                                                                        @if (objMT_TipoTrab.Control_Equipo.Equals("S"))
                                                                        {
                                                                            <a href="@Url.Action("Equipos_OrdenTrabajo", "OrdenTrabajo", new { id = ordenTrabajo.Id_OrdenTrabajo })" target="_self" class="btn btnEquiposBoton" title="Equipos" style="text-align:center">
                                                                                @*<span aria-hidden="true" class="glyphicon glyphicon-wrench"> </span>*@
                                                                            </a>
                                                                        }

                                                                        @if (objMT_TipoTrab.Control_Integrante.Equals("S"))
                                                                        {
                                                                            <a href="@Url.Action("Integrantes_OrdenTrabajo", "OrdenTrabajo", new { id = ordenTrabajo.Id_OrdenTrabajo })" target="_self" class="btn btnIntegrantesBoton" title="Integrantes" style="text-align:center">
                                                                                @*<span aria-hidden="true" class="glyphicon glyphicon-user"> </span>*@
                                                                            </a>
                                                                        }

                                                                        @if (objMT_TipoTrab.Control_Item.Equals("S"))
                                                                        {
                                                                            <a href="@Url.Action("Items_OrdenTrabajo", "OrdenTrabajo", new { id = ordenTrabajo.Id_OrdenTrabajo })" target="_self" class="btn btnItemsBoton" title="Items" style="text-align:center">
                                                                                @*<span aria-hidden="true" class="glyphicon glyphicon-list-alt"> </span>*@
                                                                            </a>
                                                                        }

                                                                        @if (objMT_TipoTrab.Control_Medida.Equals("S"))
                                                                        {
                                                                            <a href="@Url.Action("Medidas_OrdenTrabajo", "OrdenTrabajo", new { id = ordenTrabajo.Id_OrdenTrabajo })" target="_self" class="btn btnMedidassBoton" title="Medidas" style="text-align:center">
                                                                                @*<span aria-hidden="true" class="glyphicon glyphicon-list"> </span>*@
                                                                            </a>
                                                                        }

                                                                        <a href="@Url.Action("Formularios_OT", "OrdenTrabajo", new { id = ordenTrabajo.Id_OrdenTrabajo })" target="_self" class="btn btnFormularioBoton" title="Formulario" style="text-align:center">
                                                                            @*<span aria-hidden="true" class="glyphicon glyphicon-file">
                                                                                </span>*@
                                                                        </a>

                                                                        <a href="@Url.Action("OrdenTrabajo_Valor", "OrdenTrabajo", new { id = ordenTrabajo.Id_OrdenTrabajo })" target="_self" class="btn btnValorBoton" title="Valor" style="text-align:center">
                                                                            @*<span aria-hidden="true" class="glyphicon glyphicon-list"> </span>*@
                                                                        </a>

                                                                        <a href="@Url.Action("OrdenTrabajo_Estado", "OrdenTrabajo", new { id = ordenTrabajo.Id_OrdenTrabajo })" target="_self" class="btn btnEstadoBoton" title="Estado" style="text-align:center">
                                                                            @*<span aria-hidden="true" class="glyphicon glyphicon-list"> </span>*@
                                                                        </a>

                                                                        @if (objMT_TipoTrab.Control_Raiz.Equals("S"))
                                                                        {

                                                                        <a href="@Url.Action("OrdenTrabajo_CausaRaiz", "OrdenTrabajo", new { id = ordenTrabajo.Id_OrdenTrabajo })" target="_self" class="btn btnCausaRaizBoton" title="Causa Raiz" style="text-align:center">
                                                                            @*<span aria-hidden="true" class="glyphicon glyphicon-list"> </span>*@
                                                                        </a>
                                                                        }



                                                                    </td>
                                                                    <td>@Html.DisplayFor(model => ordenTrabajo.Codigo_Cliente)</td>
                                                                    <td>@Html.DisplayFor(model => ordenTrabajo.NombreContrato)</td>
                                                                    @*<td>@Html.DisplayFor(model => ordenTrabajo.Parametro)</td>*@
                                                                    <td>@parametros</td>

                                                                </tr>
                                                                cntFila++;
                                                            }


                                                        }
                                                    </tbody>
                                                </table>
                                            </div>
                                        } //end if  Count !=0
                                    } //end if  !=null
                                }//enf lkFiltro== Null

                                if (lkFiltro != null) //&& lkFiltro.Count != 0)
                                {
                                    if (lkFiltro.Count != 0)
                                    {
                                        <div class="table-responsive" id="divFiltrado">

                                            @if (ParametroBusqueda != null)
                                            {
                                                string[] Separado = ParametroBusqueda.Split(' ');
                                                string fi = Separado[0].ToString();
                                                string ff = Separado[2].ToString();
                                                string pa = Separado[4].ToString() + ": " + Separado[5].ToString();

                                                <label class="col-md-12" style="color:black;background-color:#865fc5; text-align: left;height:24px;padding:2px 0 0 0">
                                                    <font size="2" color="#ffffff">B&uacute;squeda con Filtro:&nbsp;&nbsp;Fecha Asignacion:&nbsp;&nbsp;@fi&nbsp;&nbsp;-&nbsp;&nbsp;@ff&nbsp;&nbsp;&nbsp;&nbsp;[@pa]</font>
                                                </label>
                                            }

                                            @*<label class="col-md-12" style="color:white;background-color:#865fc5; text-align: center;height:24px;padding:2px 0 0 0">
                                                    <font size="2">B&uacute;squeda Con filtro de Fecha</font>
                                                </label>*@
                                            <table id="tablaTiposTrabajo" class="js-dynamitable table table-bordered  ">
                                                @*          table table-bordered table-hover  ">*@

                                                <thead>
                                                    <tr>
                                                        <th>Acciones</th>
                                                        <th>C&oacute;digo</th>
                                                        <th>Nombre Persona</th>
                                                        <th>Parametro</th>

                                                    </tr>
                                                </thead>
                                                <tbody>

                                                    @{ int cntFila = 0; string estilo = string.Empty; }
                                                    @foreach (var ordenTrabajoFiltro in lkFiltro)
                                                    {
                                                        if ((cntFila % 2) == 0)
                                                        {
                                                            estilo = "background-color:#f9f9f9";
                                                        }
                                                        else
                                                        {
                                                            estilo = "";
                                                        }
                                                        DataBase_Externo dbe = new DataBase_Externo();
                                                        var objMT_TipoTrab = dbe.ObtenerCriterioAccionOT(ordenTrabajoFiltro.Id_tipo_trabajo_ejecutado);

                                                        <tr style="@estilo">
                                                            <td>

                                                                <a href="@Url.Action("Editar_OrdenTrabajo", "OrdenTrabajo", new { id = @ordenTrabajoFiltro.Id_OrdenTrabajo })" data-popup="tooltip" title="Editar" target="_self" class="btn btnEditarBoton" style="text-align:center">
                                                                    @*<span aria-hidden="true" class="glyphicon glyphicon-edit">
                                                                    </span>*@
                                                                </a>


                                                                @*<a href="@Url.Action("EliminarOrdenTrabajo", "OrdenTrabajo", new { id = ordenTrabajoFiltro.Id_OrdenTrabajo })" target="_self" class="btn btn-primary" title="Eliminar" style="text-align:center">
                                                                     <span aria-hidden="true" class="glyphicon glyphicon-remove"> </span>
                                                                </a>*@

                                                                @*<button type="button" class="btn btnEditarBoton class_editar_EntregaOrden" title="Editar" style="text-align:center" data-toggle="modal" data-target="#modalEditarEntregaOrden" data-id="@ordenTrabajoFiltro.Id_OrdenTrabajo">
                                                                    <span aria-hidden="true" class="glyphicon glyphicon-stop"> </span>
                                                                </button>*@

                                                                @*<a href="@Url.Action("OrdenEntregaTrabajoOrden", "OrdenTrabajo", new { id = ordenTrabajoFiltro.Id_OrdenTrabajo })" target="_self" class="btn btn-primary" title="EntregaOrdenTrabajo" style="text-align:center">
                                                                    @*<span aria-hidden="true" class="glyphicon glyphicon-stop"> </span>
                                                                </a>*@

                                                                <a href="@Url.Action("Actividades_OrdenTrabajo", "OrdenTrabajo", new { id = ordenTrabajoFiltro.Id_OrdenTrabajo })" target="_self" class="btn btnActividadesBoton" title="Actividades" style="text-align:center">
                                                                   @*<span aria-hidden="true" class="glyphicon glyphicon-list"> </span>*@
                                                                </a>
                                                                @if (objMT_TipoTrab.Control_Equipo.Equals("S"))
                                                                {
                                                                    <a href="@Url.Action("Equipos_OrdenTrabajo", "OrdenTrabajo", new { id = ordenTrabajoFiltro.Id_OrdenTrabajo })" target="_self" class="btn btnEquiposBoton" title="Equipos" style="text-align:center">
                                                                        @*<span aria-hidden="true" class="glyphicon glyphicon-wrench"> </span>*@
                                                                    </a>
                                                                }

                                                                @if (objMT_TipoTrab.Control_Integrante.Equals("S"))
                                                                {
                                                                    <a href="@Url.Action("Integrantes_OrdenTrabajo", "OrdenTrabajo", new { id = ordenTrabajoFiltro.Id_OrdenTrabajo })" target="_self" class="btn btnIntegrantesBoton" title="Integrantes" style="text-align:center">
                                                                        @*<span aria-hidden="true" class="glyphicon glyphicon-user"> </span>*@
                                                                    </a>
                                                                }

                                                                @if (objMT_TipoTrab.Control_Item.Equals("S"))
                                                                {
                                                                    <a href="@Url.Action("Items_OrdenTrabajo", "OrdenTrabajo", new { id = ordenTrabajoFiltro.Id_OrdenTrabajo })" target="_self" class="btn btnItemsBoton" title="Items" style="text-align:center">
                                                                        @*<span aria-hidden="true" class="glyphicon glyphicon-list-alt"> </span>*@
                                                                    </a>
                                                                }

                                                                @if (objMT_TipoTrab.Control_Medida.Equals("S"))
                                                                {
                                                                    <a href="@Url.Action("Medidas_OrdenTrabajo", "OrdenTrabajo", new { id = ordenTrabajoFiltro.Id_OrdenTrabajo })" target="_self" class="btn btnMedidassBoton" title="Medidas" style="text-align:center">
                                                                       @*<span aria-hidden="true" class="glyphicon glyphicon-list"> </span>*@
                                                                    </a>
                                                                }

                                                                <a href="@Url.Action("Formularios_OT", "OrdenTrabajo", new { id = ordenTrabajoFiltro.Id_OrdenTrabajo })" target="_self" class="btn btnFormularioBoton" title="Formulario" style="text-align:center">
                                                                        @*<span aria-hidden="true" class="glyphicon glyphicon-file">
                                                                        </span>*@
                                                                    </a>

                                                                    <a href="@Url.Action("OrdenTrabajo_Valor", "OrdenTrabajo", new { id = ordenTrabajoFiltro.Id_OrdenTrabajo })" target="_self" class="btn btnValorBoton" title="Valor" style="text-align:center">
                                                                       @*<span aria-hidden="true" class="glyphicon glyphicon-list"> </span>*@
                                                                    </a>

                                                                    <a href="@Url.Action("OrdenTrabajo_Estado", "OrdenTrabajo", new { id = ordenTrabajoFiltro.Id_OrdenTrabajo })" target="_self" class="btn btnEstadoBoton" title="Estado" style="text-align:center">
                                                                       @*<span aria-hidden="true" class="glyphicon glyphicon-list"> </span>*@
                                                                    </a>

                                                                @if (objMT_TipoTrab.Control_Raiz.Equals("S"))
                                                                {
                                                                <a href="@Url.Action("OrdenTrabajo_CausaRaiz", "OrdenTrabajo", new { id = ordenTrabajoFiltro.Id_OrdenTrabajo })" target="_self" class="btn btnCausaRaizBoton" title="Causa Raiz" style="text-align:center">
                                                                    @*<span aria-hidden="true" class="glyphicon glyphicon-list"> </span>*@
                                                                </a>
                                                                }



                                                            </td>
                                                            <td>@Html.DisplayFor(model => ordenTrabajoFiltro.Codigo_Cliente)</td>
                                                            <td>@Html.DisplayFor(model => ordenTrabajoFiltro.NombreContrato)</td>
                                                            <td>@Html.DisplayFor(model => ordenTrabajoFiltro.Parametro)</td>

                                                        </tr>
                                                        //         cntFila++;
                                                    }
                                                </tbody>
                                            </table>
                                        </div>
                                    }
                                    else
                                    {
                                        <label class="col-md-12" style="color:black;background-color:#f2f5f7; text-align: left;height:24px;padding:2px 0 0 0">
                                            <font size="2"> No se encontraron registro</font>
                                        </label>
                                    }//end if  Count !=0
                                } //end if  !=null
                                  //}fin else lkFiltro != null
                            }
                        </div>
                    </div>
                </div>

                <!--Div Canvas-->
                <div id="divCanvasUPD" class="row" style="display:none">
                    <div class="col-md-12">
                        <!--BOX<div class="box">-->
                        @*    <div class="box-header" style="background-color:#6ccad9"><b>Busqueda de Orden de Trabajo</b></div>*@
                        <div class="box-body">
                            @*<label class="col-md-12" style="color:white;background-color:#f39c12; text-align: center;height:26px;padding:3px 0 0 0">
                                    <font size="2">Estado de Orden de Trabajo</font>
                                </label>*@
                            @if (ParametroBusqueda != null)
                            {
                                string[] Separado = ParametroBusqueda.Split(' ');
                                string fi = Separado[0].ToString();
                                string ff = Separado[2].ToString();
                                string pa = Separado[4].ToString();

                                <label class="col-md-12" style="color:black;background-color:#865fc5; text-align: left;height:24px;padding:2px 0 0 0">
                                    <font size="2" color="#ffffff">B&uacute;squeda con Filtro:&nbsp;&nbsp;Fecha Asignacion:&nbsp;&nbsp;@fi&nbsp;&nbsp;-&nbsp;&nbsp;@ff&nbsp;&nbsp;&nbsp;&nbsp;<span class="fa fa-ellipsis-v"></span>&nbsp;&nbsp;@pa</font>
                                </label>
                                <br />
                            }

                            <div class="box-body">
                                <!--Insert-->
                                <div class="col-md-12" style="padding:2px;">
                                    <div class="form-group">
                                        @*<table><tr><td></td></tr></table>*@
                                        <font size="2"> Buscar &nbsp;&nbsp;</font>
                                        <input id="filtro" type="text" style="height:22px; width:160px;" placeholder="Buscar" />
                                    </div>
                                </div>
                                <!-- <label class="col-md-12" style="color:black;background-color:#5bc0de; text-align: center;height:3px;padding:3px 0 0 0">
                                </label><br /><br />......-->
                                @{
                                    List<ListaOrdenesParametros> lkProcesoCV = new List<ListaOrdenesParametros>();
                                    List<ListaOrdenesParametros> lkAlertaCV = new List<ListaOrdenesParametros>();
                                    List<ListaOrdenesParametros> lkCaidaCV = new List<ListaOrdenesParametros>();


                                    if (lkFiltro == null)
                                    {
                                        if (listaOrdenTrabajo != null)
                                        {
                                            foreach (var Registro in listaOrdenTrabajo)
                                            {
                                                ListaOrdenesParametros gsparametros = new ListaOrdenesParametros();

                                                DataBase_Externo dbu = new DataBase_Externo();
                                                string parametros = dbu.IsValidParametro(Registro.Id_OrdenTrabajo,  Registro.Id_contrato, Registro.Codigo_Cliente);

                                                if (parametros != null)//te,mporal [porque no todos tienen los 3 parametros
                                                {


                                                    //if (Registro.Parametro.Equals("En proceso"))
                                                    if (parametros.Equals("EN PROCESO"))
                                                    {
                                                        gsparametros.Id_OrdenTrabajo = Registro.Id_OrdenTrabajo;
                                                        gsparametros.Codigo_Interno = Registro.Codigo_Cliente;
                                                        gsparametros.Nombre_Completo = Registro.NombreContrato;
                                                        gsparametros.Parametro = Registro.Parametro;

                                                        if (Registro.Fecha_asignacion_grupo_trabajo != null)
                                                        {
                                                            string cadena = Registro.Fecha_asignacion_grupo_trabajo.ToString();
                                                            string[] Separado = cadena.Split('/');
                                                            string dia = Separado[0].ToString();
                                                            string mes = Separado[1].ToString();
                                                            //int posDia = dia.Length;int posMes = mes.Length;

                                                            string nuevoDia = Separado[0].PadLeft(2, '0');
                                                            string nuevoMes = Separado[1].PadLeft(2, '0');
                                                            string[] SeparaHora = Separado[2].Split(' ');



                                                            string anho = SeparaHora[0].ToString();
                                                            gsparametros.Fecha_Asignacion = nuevoDia + "/" + nuevoMes + "/" + anho;

                                                            //gsparametros.Fecha_Asignacion = Registro.Fecha_asignacion_grupo_trabajo;
                                                            //gsparametros.codigoDiferente = Registro.Codigo;
                                                        }
                                                        lkProcesoCV.Add(gsparametros);
                                                    }
                                                    else if (parametros.Equals("ALERTA"))
                                                    //else if (Registro.Parametro.Equals("Alerta"))
                                                    {
                                                        gsparametros.Id_OrdenTrabajo = Registro.Id_OrdenTrabajo;
                                                        gsparametros.Codigo_Interno = Registro.Codigo_Cliente;
                                                        gsparametros.Nombre_Completo = Registro.NombreContrato;
                                                        gsparametros.Parametro = Registro.Parametro;

                                                        if (Registro.Fecha_asignacion_grupo_trabajo != null)
                                                        {
                                                            string cadena = Registro.Fecha_asignacion_grupo_trabajo.ToString();
                                                            string[] Separado = cadena.Split('/');
                                                            string dia = Separado[0].ToString();
                                                            string mes = Separado[1].ToString();
                                                            //int posDia = dia.Length;int posMes = mes.Length;

                                                            string nuevoDia = Separado[0].PadLeft(2, '0');
                                                            string nuevoMes = Separado[1].PadLeft(2, '0');
                                                            string[] SeparaHora = Separado[2].Split(' ');



                                                            string anho = SeparaHora[0].ToString();
                                                            gsparametros.Fecha_Asignacion = nuevoDia + "/" + nuevoMes + "/" + anho;

                                                            //gsparametros.Fecha_Asignacion = Registro.Fecha_asignacion_grupo_trabajo;
                                                            //gsparametros.codigoDiferente = Registro.Codigo;
                                                        }
                                                        lkAlertaCV.Add(gsparametros);
                                                    }
                                                    else if (parametros.Equals("CAIDA"))
                                                    {
                                                        gsparametros.Id_OrdenTrabajo = Registro.Id_OrdenTrabajo;
                                                        gsparametros.Codigo_Interno = Registro.Codigo_Cliente;
                                                        gsparametros.Nombre_Completo = Registro.NombreContrato;
                                                        gsparametros.Parametro = Registro.Parametro;

                                                        if (Registro.Fecha_asignacion_grupo_trabajo != null)
                                                        {
                                                            string cadena = Registro.Fecha_asignacion_grupo_trabajo.ToString();
                                                            string[] Separado = cadena.Split('/');
                                                            string dia = Separado[0].ToString();
                                                            string mes = Separado[1].ToString();
                                                            //int posDia = dia.Length;int posMes = mes.Length;

                                                            string nuevoDia = Separado[0].PadLeft(2, '0');
                                                            string nuevoMes = Separado[1].PadLeft(2, '0');
                                                            string[] SeparaHora = Separado[2].Split(' ');



                                                            string anho = SeparaHora[0].ToString();
                                                            gsparametros.Fecha_Asignacion = nuevoDia + "/" + nuevoMes + "/" + anho;

                                                            //gsparametros.Fecha_Asignacion = Registro.Fecha_asignacion_grupo_trabajo;
                                                            //gsparametros.codigoDiferente = Registro.Codigo;
                                                        }
                                                        lkCaidaCV.Add(gsparametros);
                                                    }
                                                    //ContFilas++;
                                                }//fin tmp
                                            }
                                        }//...fin if !=null}
                                    }
                                    //...LkFiltro
                                    if (lkFiltro != null) //&& lkFiltro.Count != 0)
                                    {
                                        if (lkFiltro.Count != 0)
                                        {
                                            foreach (var RegistroFiltro in lkFiltro)
                                            {
                                                ListaOrdenesParametros gsparametros = new ListaOrdenesParametros();
                                                DataBase_Externo dbu = new DataBase_Externo();
                                                string parametros = dbu.IsValidParametro(RegistroFiltro.Id_OrdenTrabajo, RegistroFiltro.Id_contrato, RegistroFiltro.Codigo_Cliente);
                                                if (parametros != null)//te,mporal [porque no todos tienen los 3 parametros
                                                {
                                                    if (parametros.Equals("EN PROCESO"))
                                                    {
                                                        gsparametros.Id_OrdenTrabajo = RegistroFiltro.Id_OrdenTrabajo;
                                                        gsparametros.Codigo_Interno = RegistroFiltro.Codigo_Cliente;
                                                        gsparametros.Nombre_Completo = RegistroFiltro.NombreContrato;
                                                        gsparametros.Parametro = RegistroFiltro.Parametro;

                                                        if (RegistroFiltro.Fecha_asignacion_grupo_trabajo != null)
                                                        {
                                                            string cadena = RegistroFiltro.Fecha_asignacion_grupo_trabajo.ToString();
                                                            string[] Separado = cadena.Split('/');
                                                            string dia = Separado[0].ToString();
                                                            string mes = Separado[1].ToString();
                                                            //int posDia = dia.Length;int posMes = mes.Length;

                                                            string nuevoDia = Separado[0].PadLeft(2, '0');
                                                            string nuevoMes = Separado[1].PadLeft(2, '0');
                                                            string[] SeparaHora = Separado[2].Split(' ');



                                                            string anho = SeparaHora[0].ToString();
                                                            gsparametros.Fecha_Asignacion = nuevoDia + "/" + nuevoMes + "/" + anho;

                                                            //gsparametros.Fecha_Asignacion = Registro.Fecha_asignacion_grupo_trabajo;
                                                            //gsparametros.codigoDiferente = Registro.Codigo;
                                                        }
                                                        lkProcesoCV.Add(gsparametros);
                                                    }
                                                    else if (parametros.Equals("ALERTA"))
                                                    {
                                                        gsparametros.Id_OrdenTrabajo = RegistroFiltro.Id_OrdenTrabajo;
                                                        gsparametros.Codigo_Interno = RegistroFiltro.Codigo_Cliente;
                                                        gsparametros.Nombre_Completo = RegistroFiltro.NombreContrato;
                                                        gsparametros.Parametro = RegistroFiltro.Parametro;

                                                        if (RegistroFiltro.Fecha_asignacion_grupo_trabajo != null)
                                                        {
                                                            string cadena = RegistroFiltro.Fecha_asignacion_grupo_trabajo.ToString();
                                                            string[] Separado = cadena.Split('/');
                                                            string dia = Separado[0].ToString();
                                                            string mes = Separado[1].ToString();
                                                            //int posDia = dia.Length;int posMes = mes.Length;

                                                            string nuevoDia = Separado[0].PadLeft(2, '0');
                                                            string nuevoMes = Separado[1].PadLeft(2, '0');
                                                            string[] SeparaHora = Separado[2].Split(' ');



                                                            string anho = SeparaHora[0].ToString();
                                                            gsparametros.Fecha_Asignacion = nuevoDia + "/" + nuevoMes + "/" + anho;

                                                            //gsparametros.Fecha_Asignacion = Registro.Fecha_asignacion_grupo_trabajo;
                                                            //gsparametros.codigoDiferente = Registro.Codigo;
                                                        }
                                                        lkAlertaCV.Add(gsparametros);
                                                    }
                                                    else if (parametros.Equals("CAIDA"))
                                                    {
                                                        gsparametros.Id_OrdenTrabajo = RegistroFiltro.Id_OrdenTrabajo;
                                                        gsparametros.Codigo_Interno = RegistroFiltro.Codigo_Cliente;
                                                        gsparametros.Nombre_Completo = RegistroFiltro.NombreContrato;
                                                        gsparametros.Parametro = RegistroFiltro.Parametro;

                                                        if (RegistroFiltro.Fecha_asignacion_grupo_trabajo != null)
                                                        {
                                                            string cadena = RegistroFiltro.Fecha_asignacion_grupo_trabajo.ToString();
                                                            string[] Separado = cadena.Split('/');
                                                            string dia = Separado[0].ToString();
                                                            string mes = Separado[1].ToString();
                                                            //int posDia = dia.Length;int posMes = mes.Length;

                                                            string nuevoDia = Separado[0].PadLeft(2, '0');
                                                            string nuevoMes = Separado[1].PadLeft(2, '0');
                                                            string[] SeparaHora = Separado[2].Split(' ');


                                                            string anho = SeparaHora[0].ToString();
                                                            gsparametros.Fecha_Asignacion = nuevoDia + "/" + nuevoMes + "/" + anho;

                                                            //gsparametros.Fecha_Asignacion = Registro.Fecha_asignacion_grupo_trabajo;
                                                            //gsparametros.codigoDiferente = Registro.Codigo;
                                                        }
                                                        lkCaidaCV.Add(gsparametros);
                                                    }
                                                    //ContFilas++;
                                                }//fin tmp 


                                            }
                                        }
                                    }//fin lkFiltro != null

                                }
                                <!---->

                                <div class="blocos">
                                    <!--Div central-->
                                    <div class="col-md-12 divContenedor">

                                        <!--Div En Proceso style = "height: 100px;width: 200px; overflow-y: auto;-->
                                        <div class="bloco col-md-4 left">
                                            <div class="box box-default ">
                                                <div class="box-header alert-success" style="height:38px;">

                                                    <div class="form-group">
                                                        <label for="recipient-name" class="col-md-10 control-label" style="text-align:center">
                                                            <font color="white" size="2">EN PROCESO</font>
                                                        </label>
                                                        @*<label for="recipient-name" class="col-md-9 control-label text-center">ALERTA</label>*@
                                                        <label class="col-md-2">
                                                            <span class="label label-default">&nbsp;@lkProcesoCV.Count()&nbsp;</span>
                                                        </label>
                                                    </div>
                                                </div>
                                                @*<h4 class="box-title text-bold text-center"><font color="whit" size="3">En Proceso</font></h4>*@
                                                <div class="box-body" style="height: 600px; overflow-y: auto;">

                                                    @if (lkProcesoCV.Count != 0)
                                                    {
                                                        int nRegistros = 1;
                                                        foreach (var Registro in lkProcesoCV)
                                                        {

                                                            <div class="box">
                                                                @* <div class="box-header border-radius: 20px;"> <h5 class="box-title"></h5></div>*@
                                                                <div class="box-body" style="box-shadow: 0.9px 0.9px 4px 0 #ace04a;">
                                                                    @*   <div class="box-body">*@
                                                                    <div class="bloco">
                                                                        <table id="my-table" class="table-responsive" style="font-size:12px">
                                                                            <thead><tr><td></td></tr></thead>
                                                                            <tbody>
                                                                                <tr>
                                                                                    <td>
                                                                                        <p>
                                                                                            <i class="fa fa-dot-circle-o" aria-hidden="true"></i>&nbsp;&nbsp;
                                                                                            <span class="label label-success">&nbsp;@nRegistros&nbsp;</span>
                                                                                        </p>
                                                                                    </td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    @*< span class="glyphicon glyphicon-fa-users"></span>&nbsp;&nbsp;*@
                                                                                    <td><p><i class="fa fa-users" aria-hidden="true"></i> <b>Nombre Contrato:</b>&nbsp;&nbsp;</p></td>
                                                                                    <td><p>@Registro.Nombre_Completo&nbsp;</p></td>
                                                                                    <td></td>
                                                                                </tr>
                                                                                <!-- COLSPAN="2">-->
                                                                                <tr>
                                                                                    <td><p><span class="glyphicon glyphicon-calendar"></span>&nbsp;&nbsp;<b>Fecha Asignacion:</b>&nbsp;&nbsp;</p></td>
                                                                                    <td><p>@Registro.Fecha_Asignacion</p></td>
                                                                                    <td></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td><p><span class="glyphicon glyphicon-barcode"></span>&nbsp;&nbsp;<b>Codigo Orden:</b>&nbsp;&nbsp;</p></td>
                                                                                    <td><p>@Registro.Codigo_Interno&nbsp;&nbsp;</p></td>
                                                                                    <td class="text-right">
                                                                                        &nbsp;&nbsp;&nbsp;&nbsp;


                                                                                        <a href="@Url.Action("Editar_OrdenTrabajo", "OrdenTrabajo", new { id = Registro.Id_OrdenTrabajo })" data-popup="tooltip" title="Editar Orden de Trabajo" data-original-title="Edita Usuario" target="_self">
                                                                                            @*<span aria-hidden="true" class="glyphicon glyphicon-edit"></span>*@
                                                                                            <span class="glyphicon glyphicon-pencil"></span>
                                                                                        </a>
                                                                                    </td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                        @* <img src="http ://4.bp.blogspot.com/-FbyQUvCfcsc/T-WiGWwdzZI/AAAAAAAAAuc/23NBI95QlmY/s000/gplus.png" />*@
                                                                    </div>@* </div>*@
                                                                </div>
                                                            </div>
                                                            nRegistros++;
                                                            //} FOR
                                                        }
                                                    }
                                                </div>

                                            </div>
                                        </div>

                                        <!--Div En Alerta-->
                                        <div class="bloco col-md-4 center">
                                            <div class="box box-default">
                                                <div class="box-header" style="background-color:#ffcc33;height: 38px;">

                                                    <div class="form-group ">
                                                        <label for="recipient-name" class="col-md-10 control-label">
                                                            <font color="white" size="2"><center>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ALERTA</center></font>
                                                        </label>
                                                        @*<label for="recipient-name" class="col-md-9 control-label text-center">ALERTA</label>*@
                                                        <label class="col-md-2">
                                                            <span class="label label-default">&nbsp;@lkAlertaCV.Count()&nbsp;</span>
                                                        </label>
                                                    </div>
                                                </div>

                                                @*<h4 class="box-title text-bold text-center"><font color="white" size="3">En Proceso</font></h4>*@
                                                <div class="box-body" style="height: 600px; overflow-y: auto;">
                                                    @if (lkAlertaCV.Count != 0)
                                                    {
                                                        int nRegistros = 1;
                                                        foreach (var Registro in lkAlertaCV)
                                                        {
                                                            <div class="box">
                                                                @* <div class="box-header border-radius: 20px;"> <h5 class="box-title"></h5></div>*@
                                                                <div class="box-body" style="box-shadow: 0.9px 0.9px 4px 0 #ffcc33;">
                                                                    @*   <div class="box-body">*@
                                                                    <div class="bloco">
                                                                        <table id="my-table" class="table-responsive" style="font-size:12px">
                                                                            <thead><tr><td></td></tr></thead>
                                                                            <tbody>
                                                                                <tr>
                                                                                    <td>
                                                                                        <p>
                                                                                            <i class="fa fa-dot-circle-o" aria-hidden="true"></i>&nbsp;&nbsp;
                                                                                            <span class="label label-warning">&nbsp;@nRegistros&nbsp;</span>
                                                                                        </p>
                                                                                    </td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    @*< span class="glyphicon glyphicon-fa-users"></span>&nbsp;&nbsp;*@
                                                                                    <td><p><i class="fa fa-users" aria-hidden="true"></i> <b>Nombre Contrato:</b>&nbsp;&nbsp;</p></td>
                                                                                    <td><p>@Registro.Nombre_Completo&nbsp;</p></td>
                                                                                    <td></td>
                                                                                </tr>
                                                                                <!-- COLSPAN="2">-->
                                                                                <tr>
                                                                                    <td><p><span class="glyphicon glyphicon-calendar"></span>&nbsp;&nbsp;<b>Fecha Asignacion:</b>&nbsp;&nbsp;</p></td>
                                                                                    <td><p>@Registro.Fecha_Asignacion</p></td>
                                                                                    <td></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td><p><span class="glyphicon glyphicon-barcode"></span>&nbsp;&nbsp;<b>Codigo Orden:</b>&nbsp;&nbsp;</p></td>
                                                                                    <td><p>@Registro.Codigo_Interno&nbsp;&nbsp;</p></td>
                                                                                    <td class="text-right">
                                                                                        &nbsp;&nbsp;&nbsp;&nbsp;
                                                                                        <a href="@Url.Action("Editar_OrdenTrabajo", "OrdenTrabajo", new { id = Registro.Id_OrdenTrabajo })" data-popup="tooltip" title="Editar Orden de Trabajo" data-original-title="Edita Usuario" target="_self">
                                                                                            @*<span aria-hidden="true" class="glyphicon glyphicon-edit"></span>*@
                                                                                            <span class="glyphicon glyphicon-pencil"></span>
                                                                                        </a>
                                                                                    </td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </div>@* </div>*@
                                                                </div>
                                                            </div>
                                                            nRegistros++;
                                                        }
                                                    }
                                                </div>
                                            </div>
                                        </div>

                                        <!--Div En Caida-->
                                        <div class="bloco col-md-4 right">
                                            <div class="box box-default">
                                                <div class="box-header" style="background-color:#ff0000;height: 38px;">

                                                    <div class="form-group ">
                                                        <label for="recipient-name" class="col-md-10 control-label">
                                                            <font color="white" size="2"><center>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CAIDA</center></font>
                                                        </label>
                                                        @*<label for="recipient-name" class="col-md-9 control-label text-center">CAIDA</label>*@
                                                        <label class="col-md-2">
                                                            <span class="label label-default">&nbsp;@lkCaidaCV.Count()&nbsp;</span>
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="box-body" style="height: 600px; overflow-y: auto;">
                                                    @if (lkCaidaCV.Count != 0)
                                                    {
                                                        int nRegistros = 1;
                                                        foreach (var Registro in lkCaidaCV)
                                                        {
                                                            <div class="box">
                                                                @* <div class="box-header border-radius: 20px;"> <h5 class="box-title"></h5></div>*@
                                                                <div class="box-body" style="box-shadow: 0.9px 0.9px 4px 0 #e1846e;">
                                                                    @*   <div class="box-body">*@
                                                                    <div class="bloco">
                                                                        <table id="my-table" class="table-responsive" style="font-size:12px">
                                                                            <thead><tr><td></td></tr></thead>
                                                                            <tbody>
                                                                                <tr>
                                                                                    <td>
                                                                                        <p>
                                                                                            <i class="fa fa-dot-circle-o" aria-hidden="true"></i>&nbsp;&nbsp;
                                                                                            <span class="label label-danger">&nbsp;@nRegistros&nbsp;</span>
                                                                                        </p>
                                                                                    </td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    @*< span class="glyphicon glyphicon-fa-users"></span>&nbsp;&nbsp;*@
                                                                                    <td><p><i class="fa fa-users" aria-hidden="true"></i> <b>Nombre Contrato:</b>&nbsp;&nbsp;</p></td>
                                                                                    <td><p>@Registro.Nombre_Completo&nbsp;</p></td>
                                                                                    <td></td>
                                                                                </tr>
                                                                                <!-- COLSPAN="2">-->
                                                                                <tr>
                                                                                    <td><p><span class="glyphicon glyphicon-calendar"></span>&nbsp;&nbsp;<b>Fecha Asignacion:</b>&nbsp;&nbsp;</p></td>
                                                                                    <td><p>@Registro.Fecha_Asignacion</p></td>
                                                                                    <td></td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td><p><span class="glyphicon glyphicon-barcode"></span>&nbsp;&nbsp;<b>Codigo Orden:</b>&nbsp;&nbsp;</p></td>
                                                                                    <td><p>@Registro.Codigo_Interno&nbsp;&nbsp;</p></td>
                                                                                    <td class="text-right">
                                                                                        &nbsp;&nbsp;&nbsp;&nbsp;
                                                                                        <a href="@Url.Action("Editar_OrdenTrabajo", "OrdenTrabajo", new { id = Registro.Id_OrdenTrabajo })" data-popup="tooltip" title="Editar Orden de Trabajo" data-original-title="Edita Usuario" target="_self">
                                                                                            @*<span aria-hidden="true" class="glyphicon glyphicon-edit"></span>*@
                                                                                            <span class="glyphicon glyphicon-pencil"></span>
                                                                                        </a>
                                                                                    </td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                        @* <img src="http ://4.bp.blogspot.com/-FbyQUvCfcsc/T-WiGWwdzZI/AAAAAAAAAuc/23NBI95QlmY/s000/gplus.png" />*@
                                                                    </div>@* </div>*@
                                                                </div>
                                                            </div>
                                                        }
                                                    }
                                                </div>
                                            </div>
                                        </div>

                                    </div><!--Fin DivCentral-->

                                </div>

                            </div>
                        </div>
                        <!-- </div>-->
                    </div>
                </div>

            </div>
        </div>
    </div>

</section>


<div id="modalEditarEntregaOrden" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">

                    <div class="panel-heading">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <table>
                            <tr>
                                <td>
                                    <h4 class="text-bold"> <font size="3"><span class="fa fa-edit"></span></font>&nbsp;Editar Entrega Orden Trabajo &nbsp;&nbsp; </h4>
                                </td>
                                <td>
                                    <h6>
                                        <a href="#" title="Este Formulario le permitira Editar los campos que desee." class="tooltip_elemento center">
                                            <img class="img-responsive" src="~/Content/bower_components/ImagenVQ/Info.png" id="purple">
                                        </a>
                                    </h6>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-body">
                <div id="modal-editaEntregaOrden">

                </div>
            </div>
        </div>
    </div>
</div>



@section scripts
{
    @*   <script src="~/content/bower_components/FiltroDataTable/FiltroXFecha/js3_3_1/jquery.min.js"></script>  *@



    @*<script src="~/content/bower_components/FiltroDataTable/FiltroXFecha/jqueryUI1_12_1/jquery-ui.min.js"></script>*@



    <script src="~/Content/bower_components/moment/min/moment.min.js"></script>
    <script src="~/Content/bower_components/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
    <script src="~/Content/SweetAlert/sweet.js"></script>
    @*<script src="~/content/bower_components/FiltroDataTable/FiltroXFecha/datatableMin/datatables.min.js"></script>
        <script src="~/content/bower_components/FiltroDataTable/FiltroXFecha/datepickerMin/bootstrap-datepicker.min.js"></script>

        <script src="~/content/bower_components/FiltroDataTable/FiltroXFecha/datatableMin/moment2.18.1/moment.min.js"></script>*@
   
    
    @*este es el del boton input archivo  *@
  <script src="~/Content/bower_components/EstiloExterno/JsExterno/custom-file-input.js"></script>
    @* hasta aqui *@

    @*<script src="~/Content/bower_components/jquery/dist/jquery.min.js"></script>*@
    <script src="~/Content/bower_components/select2/dist/js/select2.full.min.js"></script>



    @*<script src="~/Content/bower_components/jquery/dist/jquery.min.js"></script>*@
    <script src="~/Content/bower_components/datatables.net/js/jquery.dataTables.js"></script>
    <script src="~/Content/bower_components/datatables.net-bs/js/dataTables.bootstrap.js"></script>


    <!--Filtro de tabla-->
    <script src="~/Content/bower_components/FiltroDataTable/MantTipoTrabajo/Dynamitablevq/dynamitable.jquery.min.js"></script>

    <script type="text/javascript">

        


        $(document).ready(function () {

            $(".alert").fadeTo(2000, 500).slideUp(500, function () {
                $(".alert").slideUp(500);
            });
            $.noConflict();
            $('#tablaCanvas').DataTable({

                "language": {
                    "lengthMenu": "Display _MENU_ records per page",
                    "zeroRecords": "No Contiene registros",
                    "infoEmpty": "No hay registros disponibles",
                    "decimal": "",
                    "emptyTable": "No hay datos",
                    "info": "Mostrando _START_ a _END_ de _TOTAL_ registros",
                    "infoEmpty": "Mostrando 0 a 0 de 0 registros",
                    "infoFiltered": "(Filtro de _MAX_ total registros)",
                    "infoPostFix": "",
                    "thousands": ",",
                    "lengthMenu": "  Cantidad a Mostrar _MENU_ registros",
                    "loadingRecords": "Cargando...",
                    "processing": "Procesando...",
                    "search": "Buscar:",
                    "zeroRecords": "No se encontraron coincidencias",
                    "paginate": {
                        "first": "Primero",
                        "last": "Ultimo",
                        "next": "Siguiente",
                        "previous": "Atras"
                    },
                    "aria": {
                        "sortAscending": ": Activar orden de columna ascendente",
                        "sortDescending": ": Activar orden de columna desendente"
                    },
                },


                'paging': true,
                'lengthChange': true,
                'searching': true,
                'ordering': false,
                'info': true,
                'autoWidth': false
            });

            $('#tablaTiposTrabajo').DataTable({

                "language": {
                    "lengthMenu": "Display _MENU_ records per page",
                    "zeroRecords": "No Contiene registros",
                    "infoEmpty": "No hay registros disponibles",
                    "decimal": "",
                    "emptyTable": "No hay datos",
                    "info": "Mostrando _START_ a _END_ de _TOTAL_ registros",
                    "infoEmpty": "Mostrando 0 a 0 de 0 registros",
                    "infoFiltered": "(Filtro de _MAX_ total registros)",
                    "infoPostFix": "",
                    "thousands": ",",
                    "lengthMenu": "  Mostrar _MENU_ registros",
                    "loadingRecords": "Cargando...",
                    "processing": "Procesando...",
                    "search": "Buscar:",
                    "zeroRecords": "No se encontraron coincidencias",
                    "paginate": {
                        "first": "Primero",
                        "last": "Ultimo",
                        "next": "Siguiente",
                        "previous": "Atras"
                    },
                    "aria": {
                        "sortAscending": ": Activar orden de columna ascendente",
                        "sortDescending": ": Activar orden de columna desendente"
                    },
                },


                'paging': true,
                'lengthChange': true,
                'searching': true,
                'ordering': false,
                'info': true,
                'autoWidth': false
            });

            //$('#tablaTiposTrabajo').DataTable({
            //    'paging': true,
            //    'lengthChange': true,
            //    'searching': true,
            //    'ordering': false,
            //    'info': true,
            //    'autoWidth': false
            //})
        });

                    // Mostrar informacion de pagina
                    //var i = 2;
                    //function insertHtml() {
                    //    if (i % 2 == 0) { $("#htmlins").html("<h4>Estimado usuario</h4></hr><span>En esta pantalla administrara el proceso de mantenimiento de trabajo</span><br>") }
                    //    else {
                    //        $("#htmlins").html("")//remove();
                    //    }//.html("<span>este codigo html fue insertado</span>") }

                    //    i++;
                    //};


                    var contLista = 0;
    var contCanvas = 0;

    function mostrarLista() {
        contLista = 1;

        if (contLista == 1 && contCanvas == 0)
        {
            document.getElementById('divLista').style.display = 'block';
            document.getElementById('divCanvasUPD').style.display = 'none';
            contCanvas = 0;
        }
        if (contLista = 1)
        {
            window.location.reload();
        }
        contLista = 0;

    }

    function mostrarCanvasUDP() {
        contCanvas = 1;
        if (contCanvas == 1 && contLista == 0)
        {
            document.getElementById('divCanvasUPD').style.display = 'block';
            document.getElementById('divLista').style.display = 'none';
            contLista = 0;
        }

        contCanvas = 0;
    }


    var contFiltro = 0;
    function mostrarDivFiltro() {

        if (contFiltro % 2 == 0)
        {
            document.getElementById('divFiltro').style.display = 'block';

            //contLista = 0;
        }
        else
        {
            document.getElementById('divFiltro').style.display = 'none';
        }
        contFiltro = contFiltro + 1;
    }

                    //Combo Parametro

                    $(document).ready(function () {        //
                        $('.select2').select2({
            dropdownParent: $('#modal1')
                        });
    });

                    $(function () {
                        $("#filtro").keyup(function() {
            var texto = $(this).val();

                            $(".bloco").each(function() {
                var resultado = $(this).text().toLowerCase().indexOf(texto.toLowerCase());

                if (resultado < 0)
                {
                                    $(this).fadeOut();
                }
                else
                {
                                    $(this).fadeIn();
                }
            });
        });
    });

    start = new Date(moment().subtract(6, 'days'));
                    end = new Date(moment());

                    $('#FeInicio').val(moment(start).format('DD/MM/YYYY'))
                    $('#FeFin').val(moment(end).format('DD/MM/YYYY'))

                    $('#FeInicio').datepicker(
                    {
    format: "dd/mm/yyyy",
                        autoclose: true
                    });

                    $('#FeFin').datepicker(
                    {
    format: "dd/mm/yyyy",
                        autoclose: true
                    });


                    function ValidaFecha(form) {
                        var fecha_ap = $('#FeInicio').val();
                        var fecha_ci = $('#FeFin').val();

                        var datearray1 = fecha_ap.split("/");
                        var newdate_ap = datearray1[1] + '/' + datearray1[0] + '/' + datearray1[2];

                        var datearray2 = fecha_ci.split("/");
                        var newdate_ci = datearray2[1] + '/' + datearray2[0] + '/' + datearray2[2];

                        var primera = Date.parse(newdate_ap);
                        var segunda = Date.parse(newdate_ci);
                        if (segunda < primera) {
                            swal('', 'Fecha hasta debe ser mayor', 'error');
                        }
                        else {
                            var obj = document.getElementById("btnSubmitFiltro");

                            if (obj) {
                                obj.click();
                            }
                        }
                    }
                    /*
        Html.DropDownList("IdCmbParametro",
        new SelectList(new List<string>() { "Ninguno", "Tipos de Trabajo", "Campamento", "Estacion", "Sector", "Sucursal" }),
        new { id = "CmbParametro", class = "form-control select2", Style = "height:27px;width:110px;font-size:8pt" })

                  1  "Ninguno"
                  2  "Tipos de Trabajo"
                  3  "Campamento"
                  4  "Estacion"
                  5  "Sector"
                  6  "Sucursal"
                        */
                    $('#formTipoTrabajo').prop("hidden", true);
                    $('#formCampamento').prop("hidden", true);
                    $('#formSucursal').prop("hidden", true);
                    $('#formEstacion').prop("hidden", true);
                    $('#formSector').prop("hidden", true);
                    $('#formContrato').prop("hidden", true);
                    $('#formEstado').prop("hidden", true);
                    $('#formCliente').prop("hidden", true);
function CmbParametroSelected()
{
    //var cod = document.getElementById("CmbParametro").value;
    //alert(cod);

    var combo = document.getElementById("CmbParametro");
    var selected = combo.options[combo.selectedIndex].text;
    //alert(selected);

    // $('#CmbParametro').change(function (e) {

    if (selected == 'Ninguno')
    {
                                $('#formTipoTrabajo').prop("hidden", true);
                                $('#formCampamento').prop("hidden", true);
                                $('#formSucursal').prop("hidden", true);
                                $('#formEstacion').prop("hidden", true);
                                $('#formSector').prop("hidden", true);
                                $('#formContrato').prop("hidden", true);
                                $('#formEstado').prop("hidden", true);
                                $('#formCliente').prop("hidden", true);
    }
    else if (selected == 'Tipos_Trabajo')
    {
                                $('#formTipoTrabajo').prop("hidden", false);
                                $('#formCampamento').prop("hidden", true);
                                $('#formSucursal').prop("hidden", true);
                                $('#formEstacion').prop("hidden", true);
                                $('#formSector').prop("hidden", true);
                                $('#formContrato').prop("hidden", true);
                                $('#formEstado').prop("hidden", true);
                                $('#formCliente').prop("hidden", true);
    }
    else if (selected == 'Campamento')
    {
                                $('#formTipoTrabajo').prop("hidden", true);
                                $('#formCampamento').prop("hidden", false);
                                $('#formSucursal').prop("hidden", true);
                                $('#formEstacion').prop("hidden", true);
                                $('#formSector').prop("hidden", true);
                                $('#formContrato').prop("hidden", true);
                                $('#formEstado').prop("hidden", true);
                                $('#formCliente').prop("hidden", true);
    }
    else if (selected == 'Estacion')
    {
                                $('#formTipoTrabajo').prop("hidden", true);
                                $('#formCampamento').prop("hidden", true);
                                $('#formSucursal').prop("hidden", true);
                                $('#formEstacion').prop("hidden", false);
                                $('#formSector').prop("hidden", true);
                                $('#formContrato').prop("hidden", true);
                                $('#formEstado').prop("hidden", true);
                                $('#formCliente').prop("hidden", true);
    }
    else if (selected == 'Sector')
    {
                                $('#formTipoTrabajo').prop("hidden", true);
                                $('#formCampamento').prop("hidden", true);
                                $('#formSucursal').prop("hidden", true);
                                $('#formEstacion').prop("hidden", true);
                                $('#formSector').prop("hidden", false);
                                $('#formContrato').prop("hidden", true);
                                $('#formEstado').prop("hidden", true);
                                $('#formCliente').prop("hidden", true);
    }
    else if (selected == 'Sucursal')
    {
                                $('#formTipoTrabajo').prop("hidden", true);
                                $('#formCampamento').prop("hidden", true);
                                $('#formSucursal').prop("hidden", false);
                                $('#formEstacion').prop("hidden", true);
                                $('#formSector').prop("hidden", true);
                                $('#formContrato').prop("hidden", true);
                                $('#formEstado').prop("hidden", true);
                                $('#formCliente').prop("hidden", true);
    }
    else if (selected == 'Contrato')
    {
                                $('#formTipoTrabajo').prop("hidden", true);
                                $('#formCampamento').prop("hidden", true);
                                $('#formSucursal').prop("hidden", true);
                                $('#formEstacion').prop("hidden", true);
                                $('#formSector').prop("hidden", true);
                                $('#formContrato').prop("hidden", false);
                                $('#formEstado').prop("hidden", true);
                                $('#formCliente').prop("hidden", true);
    }
    else if (selected == 'Estado')
    {
                                $('#formTipoTrabajo').prop("hidden", true);
                                $('#formCampamento').prop("hidden", true);
                                $('#formSucursal').prop("hidden", true);
                                $('#formEstacion').prop("hidden", true);
                                $('#formSector').prop("hidden", true);
                                $('#formContrato').prop("hidden", true);
                                $('#formEstado').prop("hidden", false);
                                $('#formCliente').prop("hidden", true);
    }
    else if (selected == 'Cliente') {
                                $('#formTipoTrabajo').prop("hidden", true);
                                $('#formCampamento').prop("hidden", true);
                                $('#formSucursal').prop("hidden", true);
                                $('#formEstacion').prop("hidden", true);
                                $('#formSector').prop("hidden", true);
                                $('#formContrato').prop("hidden", true);
                                $('#formEstado').prop("hidden", true);
                                $('#formCliente').prop("hidden", false);
    }


    //});
}

                                                        @*$('#CmbParametro').on('change', function (event)
    {
        var url = '@Url.Action("GetTiposTrabajo", "OrdenTrabajo", new { id = "param-id" })';
        url = url.replace("param-id", event.target.value);
        ejecutaAjax('comboTipoTrabajo', url);
    });*@

                                                        @*function ejecutaAjax(id, url) {

        $.ajax({
            type: 'GET',
            url: url,
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            success: function (data) {

                $("#" + id).empty();
                $.each(data, function (i, item) {

                    var seleccion = '';
                    if (i == 0)
                    {
                        $("#" + id).append("<option value='" + data[i].Value + "' selected='selected'>" + data[i].Text + "</option>");
                    }
                    else {
                        $("#" + id).append("<option value='" + data[i].Value + "'>" + data[i].Text + "</option>");
                    }
                });
            },
            error: function (data) {
                window.location.href = '@Url.Action("Error","Errores")';
                //window.location.href = '/Errores/Error';
            }
        });
    }*@

    </script>
}
@*06-11-2018 15:03*@
